<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../../public/css/Geroyn.css">
  <link rel="stylesheet" href="../../../public/css/pie.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.css' rel='stylesheet' />
  <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.js'></script>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <title>Gero y Natis</title>
  <link rel="icon" href="../../../public/images/Gero_y_Natis Logo.png" type="image/png">

  <style>
    .dashboard {
        background: linear-gradient(135deg, #e6f7ff, #e6ffe6);
        border: 2px solid black;
        border-radius: 15px;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
        overflow: hidden;
        width: 100%;
        max-width: 1000px;
    }
    .header {
        background-color: #b93f39;
        color: black;
        text-align: center;
        padding: 20px;
        font-size: 24px;
        font-weight: bold;
    }
    .content {
        display: flex;
        flex-wrap: wrap;
        padding: 20px;
    }
    .calendar {
        flex: 1;
        min-width: 300px;
        background-color: white;
        border-radius: 10px;
        padding: 15px;
        margin-right: 20px;
        margin-bottom: 20px;
        height: 400px;
    }
    .sales-summary {
        flex: 1;
        min-width: 300px;
    }
    .total-sales {
        font-size: 36px;
        font-weight: bold;
        color: #310f0d;
        text-align: center;
        margin-bottom: 20px;
    }
    .tabs {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
    }
    .tab {
        flex: 1;
        text-align: center;
        padding: 10px;
        background-color: #dddddd;
        cursor: pointer;
    }
    .tab.active {
        background-color: #b93f39;
        color: white;
    }
    .chart {
        background-color: white;
        border-radius: 10px;
        padding: 15px;
        height: 200px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-style: italic;
        color: #666;
    }
    #dailySales {
        margin-top: 20px;
        padding: 10px;
        background-color: #f9f9f9;
        border-radius: 5px;
        text-align: center;
    }
    .invoices-table {
        width: 100%;
        border-collapse: collapse;
        background-color: white;
        border-radius: 10px;
        overflow: hidden;
    }
    .invoices-table th,
    .invoices-table td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    .invoices-table th {
        background-color: #b93f39;
        color: white;
    }
    .no-invoices {
        text-align: center;
        font-style: italic;
        color: #666;
    }
  </style>
</head>

<body>
  <!-- Header de Navegación Compacto -->
  <div class="header-nav">
    <div class="header-nav-background"></div>
    
    <nav class="navbar navbar-expand-lg">
      <div class="container">
        <!-- Botón atrás, Logo e imagen a la izquierda -->
        <div class="d-flex align-items-center">
          <!-- Botón para ir atrás -->
          <button class="btn-back me-3" onclick="window.location.href='../../app/Controllers/controladorInventario.php'"  title="Ir atrás">
            <i class="fas fa-arrow-left"></i>
          </button>
          
          <!-- Logo imagen -->
          <img src="../../../public/images/Gero_y_Natis Logo.png" alt="Logo Gero y Natis" class="logo-img">
          
          <!-- Nombre de la empresa -->
          <a class="navbar-brand" href="#dashboard">
            Gero y Natis
          </a>
        </div>
        
        <!-- Botón hamburguesa para móvil -->
        <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavigation">
          <i class="fas fa-bars" style="color: #333;"></i>
        </button>
        
        <!-- Links de navegación y menú de usuario -->
        <div class="collapse navbar-collapse" id="navbarNavigation">
          <!-- Links centrados -->
          <ul class="navbar-nav mx-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="../../../app/Controllers/controladorInventario.php"><i class="far fa-copy me-2"></i>Inicio</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../../../app/Controllers/controladorInventario2.php"><i class="fa-regular fa-clipboard"></i> Inventario</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../../../app/Controllers/controladorProveedores.php"><i class="bi bi-file-person"></i> Proveedores</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../../../app/Controllers/controladorMovimiento.php"> <i class="bi bi-book-half"></i> Movimientos</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="../../../app/Controllers/controladorVentas.php"><i class="fa-regular fa-credit-card"></i> Ventas</a>
            </li>
          </ul>
          
          <!-- Menú de usuario a la derecha -->
          <div class="user-menu">
            <a href="../../../app/Views/Admin/Calendario.html" class="btn-icon-nav" title="Calendario">
              <i class="fa-solid fa-calendar-days"></i>
            </a>
            <a href="../../../app/Controllers/controladorUsuario.php" class="btn-icon-nav" title="Usuarios">
              <i class="fa-solid fa-user"></i>
            </a>
            <a href="../../../app/Views/Auth/Cerrar Sesion.php" class="btn-icon-nav" title="Cerrar sesión">
              <i class="fa-solid fa-door-open"></i>
            </a>
          </div>
        </div>
      </div>
    </nav>
  </div>

  <div class="container" style="padding: 0 0 50px 0; font-family: Oswald, sans-serif;">
    <div class="row">
      <div class="col-md-8">
        <h1 style="font-family: Bebas Neue, sans-serif; padding: 20px 0 0 0; font-size: 60px;">
          Calendario de Ventas
        </h1>
        <p>Aquí está lo vendido en un sistema de calendario para encontrar las ventas por fecha.</p>
        <hr>
        
        <div class="dashboard">
          <div class="content">
            <div class="calendar" id="calendar"></div>
            <div class="sales-summary">
              <div class="total-sales" id="dailySales">
                Seleccione una fecha
              </div>
              <div class="invoices">
                <h3>Facturas del período</h3>
                <table class="invoices-table">
                  <thead>
                    <tr>
                      <th>ID Factura</th>
                      <th>Total</th>
                    </tr>
                  </thead>
                  <tbody id="invoicesList">
                    <tr>
                      <td colspan="2" class="no-invoices">Seleccione una fecha para ver las facturas</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-decorative">
      <i class="fas fa-tools"></i>
    </div>
    
    <div class="container">
      <!-- Marca Principal -->
      <div class="footer-brand">
        <h2 class="footer-logo">GERO Y NATIS</h2>
        <p class="footer-tagline">Sistema de Gestión de Inventario</p>
        <p class="footer-version">Versión 1.0.0 | Instalación Local</p>
      </div>

      <!-- Sección de Soporte Técnico -->
      <div class="support-section">
        <h5 class="support-title">
          <i class="fas fa-headset"></i>
          Soporte Técnico
        </h5>
        
        <div class="contact-grid">
          <div class="contact-card">
            <div class="contact-icon">
              <i class="fas fa-phone"></i>
            </div>
            <div class="contact-label">Teléfono</div>
            <div class="contact-value">
              <a href="tel:+525512345678">+57 301 143 0988</a>
              <br>
              <a href="tel:+525512345678">+57 302 133 4678</a>
              <br>
              <a href="tel:+525512345678">+57 301 460 0998</a>
            </div>
          </div>

          <div class="contact-card">
            <div class="contact-icon">
              <i class="fab fa-whatsapp"></i>
            </div>
            <div class="contact-label">WhatsApp</div>
            <div class="contact-value">
              <a href="https://wa.me/573011480544">+57 301 444 9971</a>
              <br>
              <a href="https://wa.me/573005467787">+57 300 546 7787</a>
              <br>
              <a href="https://wa.me/573014568799">+57 301 456 8799</a>
            </div>
          </div>

          <div class="contact-card">
            <div class="contact-icon">
              <i class="fas fa-envelope"></i>
            </div>
            <div class="contact-label">Email</div>
            <div class="contact-value">
              <a href="mailto:soporte@tuempresa.com">daniel_bermeo@soy.sena.edu.co</a>
              <br>
              <a href="mailto:soporte@tuempresa.com">deisy_gonzalez@soy.sena.edu.co</a>
              <br>
              <a href="mailto:soporte@tuempresa.com">vanessa_mateus@soy.sena.edu.co</a>
            </div>
          </div>

          <div class="contact-card">
            <div class="contact-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="contact-label">Horario</div>
            <div class="contact-value">
              Lun - Vie: 9:00 - 18:00
            </div>
          </div>
        </div>

        <!-- Contacto de Emergencia -->
        <div class="emergency-contact">
          <div class="contact-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <div class="contact-label">Emergencias 24/7</div>
          <div class="contact-value">
            <a href="tel:+525587654321">+52 304 555 7689</a>
          </div>
        </div>
      </div>

      <!-- Información del Sistema -->
      <div class="system-info">
        <div class="info-item">
          <i class="fas fa-server"></i>
          <span>Sistema Local</span>
        </div>
        <div class="info-item">
          <i class="fas fa-shield-alt"></i>
          <span>Datos Seguros</span>
        </div>
        <div class="info-item">
          <i class="fas fa-tools"></i>
          <span>Mantenimiento Incluido</span>
        </div>
        <div class="info-item">
          <i class="fas fa-graduation-cap"></i>
          <span>Capacitación Disponible</span>
        </div>
      </div>

      <!-- Divisor -->
      <div class="footer-divider"></div>

      <!-- Copyright -->
      <div class="footer-bottom">
        <p class="footer-copyright">
          <strong>@2024</strong> <strong>Advertencia: </strong>Todos los derechos reservados. 
          | Sistema desarrollado para <strong>Gero y Natis</strong> | ¿Problemas? Contáctanos arriba
        </p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var calendarEl = document.getElementById('calendar');
      var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'es',
        height: 'auto',
        events: '../../Models/Calendario.php', // Ruta corregida
        dateClick: function (info) {
          const fecha = info.dateStr;
          console.log('Fecha clickeada:', fecha); // Debug
          
          fetch(`../../Models/Calendario.php?fecha=${fecha}`)
            .then(response => {
              console.log('Response status:', response.status); // Debug
              return response.json();
            })
            .then(data => {
              console.log('Datos recibidos:', data); // Debug
              
              const dailySales = document.getElementById('dailySales');
              const invoicesList = document.getElementById('invoicesList');
              invoicesList.innerHTML = '';
              
              if (data && data.length > 0) {
                let totalDia = 0;
                data.forEach(factura => {
                  totalDia += parseFloat(factura.total);
                  invoicesList.innerHTML += `
                    <tr>
                      <td>${factura.id}</td>
                      <td>$${parseFloat(factura.total).toLocaleString('es-CO')}</td>
                    </tr>
                  `;
                });
                dailySales.textContent = `Total del día: $${totalDia.toLocaleString('es-CO')}`;
              } else {
                dailySales.textContent = 'No hay ventas para esta fecha';
                invoicesList.innerHTML = `
                  <tr>
                    <td colspan="2" class="no-invoices">Sin facturas registradas</td>
                  </tr>
                `;
              }
            })
            .catch(error => {
              console.error('Error:', error);
              document.getElementById('dailySales').textContent = 'Error al cargar los datos';
            });
        }
      });
      calendar.render();
    });
  </script>

  <!-- Optional JavaScript; choose one of the two! -->
  <!-- Option 1: Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>

</body>
</html>